Created directory: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp
Created directory: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp
Available base directories: ['/home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp', '/home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp']
Created directory: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7
Created directory: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7
Available analysis directories: ['/home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7', '/home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7']
Node cluster map shape: (29, 27)
Should match U-Matrix: (29, 27)
âœ“ U-Matrix with hits overlay saved: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/umatrix_hitmap_overlay.png
âœ“ U-Matrix with hits overlay saved: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/umatrix_hitmap_overlay.png
âœ“ U-Matrix with hits overlay saved: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/umatrix_normalized_hitmap_overlay.png
âœ“ U-Matrix with hits overlay saved: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/umatrix_normalized_hitmap_overlay.png
SOM Node Cluster Map (Predicted):
[[3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 2 2 2 2 2 3]
 [3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 2 2 2 3 3]
 [3 3 3 1 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 2 3 3 3]
 [3 3 3 3 1 1 1 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3]
 [3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 1 1 3 3 3 3 3 3 3 3]
 [3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 2 2 2 2]
 [3 3 3 3 3 3 3 3 3 3 3 3 3 3 2 3 3 3 3 3 3 3 2 2 2 2 2]
 [3 3 3 3 3 3 3 3 3 3 3 3 3 2 2 2 3 3 3 3 3 3 2 2 2 2 2]
 [3 3 3 3 3 3 3 3 3 3 3 3 3 3 2 3 3 3 3 3 3 3 2 2 2 2 2]
 [3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 2 2 2 2 2]
 [1 1 1 1 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 2 3]
 [1 1 1 1 1 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3]
 [1 1 1 1 1 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3]
 [1 1 1 1 1 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3]
 [1 1 1 1 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3]
 [1 1 1 1 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3]
 [3 3 1 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 1 3 3 3 3 3 3 3 3]
 [3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3]
 [3 3 3 3 3 3 3 3 3 1 1 1 1 1 1 3 3 3 3 3 3 3 3 3 3 3 3]
 [3 3 3 3 2 3 3 3 1 1 1 1 1 1 1 1 1 1 1 3 3 3 3 3 3 3 2]
 [3 3 3 2 2 2 3 3 1 1 1 1 1 1 1 1 1 1 1 3 3 3 3 3 3 3 3]
 [3 3 3 2 4 4 3 3 1 1 1 1 1 1 1 1 1 1 1 3 3 3 3 3 3 3 3]
 [3 3 2 4 4 4 4 3 1 1 1 1 1 1 1 1 1 1 1 3 3 3 3 3 3 3 3]
 [3 2 2 2 4 4 4 3 3 1 1 1 1 1 1 1 1 1 1 3 3 3 3 3 3 3 3]
 [2 2 2 2 2 4 4 4 3 3 1 1 1 1 1 1 1 1 1 3 3 3 1 1 1 3 3]
 [2 2 2 2 3 3 4 4 4 3 1 1 1 1 1 1 1 1 3 3 3 1 1 1 1 1 1]
 [2 2 2 3 3 3 3 3 3 3 3 1 1 1 2 2 2 2 2 2 1 1 1 1 1 1 1]
 [3 3 3 3 3 3 3 3 3 3 3 1 1 1 2 2 2 2 2 2 1 1 1 1 1 1 1]
 [4 3 3 3 3 3 3 3 3 3 3 1 1 1 2 2 2 2 2 2 1 1 1 1 1 1 1]]
Final DataFrame with SOM clusters saved to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/df2_predicted_clusters.csv
Final DataFrame with SOM clusters saved to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/df2_predicted_clusters.csv

Color assignments:
  Cluster 1: RGB [31, 119, 180]
  Cluster 2: RGB [152, 223, 138]
  Cluster 3: RGB [140, 86, 75]
  Cluster 4: RGB [199, 199, 199]
âœ“ Plot saved successfully to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/som_node_predicted_cluster_map.png
âœ“ Cluster data saved to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/som_node_predicted_cluster_map.npy
âœ“ Cluster data saved as CSV: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/som_node_predicted_cluster_map2.csv
âœ“ Color mapping saved to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/cluster_colors2.txt
âœ“ Plot saved successfully to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/som_node_predicted_cluster_map.png
âœ“ Cluster data saved to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/som_node_predicted_cluster_map.npy
âœ“ Cluster data saved as CSV: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/som_node_predicted_cluster_map2.csv
âœ“ Color mapping saved to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/cluster_colors2.txt

==================================================
CLUSTER STATISTICS:
==================================================
Total SOM nodes: 783 (29 Ã— 27)

Cluster distribution:
  Cluster 1: 151 nodes (19.3%)
  Cluster 2: 79 nodes (10.1%)
  Cluster 3: 537 nodes (68.6%)
  Cluster 4: 16 nodes (2.0%)

Number of clusters found: 4
Clusters present: [1, 2, 3, 4]

SOMâ€“KMeans Cluster Support (weighted by hit counts)
============================================================
Cluster   Total hits     Mean/node      Median    Core frac (>10 hits)
1         4375           28.97          6.0       27.8%
2         1946           24.63          6.0       34.2%
3         4356           8.11           3.0       19.6%
4         355            22.19          9.5       43.8%
Neighborhood Preservation Index: 0.066
U-Matrix saved to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/u_matrix.png
U-Matrix saved to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/u_matrix.png
Node cluster map shape: (29, 27)
Should match U-Matrix: (29, 27)
âœ“ U-Matrix with KMeans overlay saved: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/umatrix_predicted_kmeans_overlay.png
âœ“ U-Matrix with KMeans overlay saved: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/umatrix_predicted_kmeans_overlay.png

ðŸŽ¯ ENVIRONMENTAL ANALYSIS: manhattan
Cluster column: predicted_Cluster
Analyzing 0 environmental variables
âŒ No environmental variables found!
âœ“ Plot saved successfully to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/som_node_cluster_map.png
âœ“ Cluster data saved to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/som_node_cluster_map.npy
âœ“ Cluster data saved as CSV: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/som_node_cluster_map.csv
âœ“ Color mapping saved to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/cluster_colors2.txt
âœ“ Plot saved successfully to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/som_node_cluster_map.png
âœ“ Cluster data saved to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/som_node_cluster_map.npy
âœ“ Cluster data saved as CSV: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/som_node_cluster_map.csv
âœ“ Color mapping saved to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/cluster_colors2.txt
Node cluster map shape: (29, 27)
Should match U-Matrix: (29, 27)
âœ“ U-Matrix with KMeans overlay saved: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/umatrix_kmeans_overlay.png
âœ“ U-Matrix with KMeans overlay saved: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/umatrix_kmeans_overlay.png
ARI: 0.252, NMI: 0.311
Failed to save final DataFrame: expected str, bytes or os.PathLike object, not list
Saved df2 with cluster info to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7
Saved df2 with cluster info to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7

ðŸŽ¯ ASSEMBLAGE GRADIENT ANALYSIS: PCA
Gradient axis: PC1
Analyzing 319 assemblage variables

ðŸ“Š CORRELATION RESULTS:
          Spearman_r  p_value   abs_r   fdr_q significance
variable                                                  
acaenc       -0.0109   0.2524  0.0109  0.3035           ns
acrarb       -0.2281   0.0000  0.2281  0.0000          ***
acrbus       -0.1079   0.0000  0.1079  0.0000          ***
acrenc       -0.1177   0.0000  0.1177  0.0000          ***
acrtab       -0.2684   0.0000  0.2684  0.0000          ***
...              ...      ...     ...     ...          ...
turfol       -0.1942   0.0000  0.1942  0.0000          ***
tursed       -0.4447   0.0000  0.4447  0.0000          ***
xesmas       -0.0105   0.2722  0.0105  0.3174           ns
zoaenc        0.0196   0.0398  0.0196  0.0565           ns
zoncof        0.0044   0.6432  0.0044  0.6865           ns

[95 rows x 5 columns]

ðŸ’ª STRONG GRADIENT DRIVERS (|r| > 0.5):
  othcca: r = 0.548, p = 0
  turfil: r = 0.845, p = 0
ðŸ“‰ Plotting 5 strong gradient taxa
âœ… Saved: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7
âœ… Saved: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7
Map plot saved successfully to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/spatial_clusters_taiwan_geomap.png
Map plot saved successfully to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/spatial_clusters_taiwan_geomap.png
Plot saved successfully to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/spatial_clusters_taiwan_shmap.png
Plot saved successfully to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/spatial_clusters_taiwan_shmap.png
Plot saved successfully to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/spatial_clusters_westtaiwan_shmap.png
Plot saved successfully to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/spatial_clusters_westtaiwan_shmap.png
Plot saved successfully to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/spatial_clusters_southtaiwan_shmap.png
Plot saved successfully to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/spatial_clusters_southtaiwan_shmap.png
Plot saved successfully to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/spatial_clusters_northtaiwan_shmap.png
Plot saved successfully to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/spatial_clusters_northtaiwan_shmap.png
Saved: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/richness_by_cluster.png
Saved: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/richness_by_cluster.png
Map plot saved successfully to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/species_richness_taiwan_geomap.png
Map plot saved successfully to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/species_richness_taiwan_geomap.png
Saved species richness map to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/species_richness_taiwan_shmap.png
Saved species richness map to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/species_richness_taiwan_shmap.png
Plot saved successfully to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/Species_overlay.png
Plot saved successfully to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/Species_overlay.png
Plot saved successfully to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/composition_by_cluster.png
Plot saved successfully to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/composition_by_cluster.png
Plot saved successfully to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/composition_by_cluster.png
Plot saved successfully to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/composition_by_cluster.png
Plot saved successfully to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/composition_by_cluster_top5.png
Plot saved successfully to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust7/composition_by_cluster_top5.png

Top 5 Categories per Cluster:
==================================================
Cluster 0:
  1. Hard coral: 43.7%
  2. Turf: 28.1%
  3. CCA: 10.6%
  4. Soft coral: 8.9%
  5. Zoanthid: 0.7%

Cluster 1:
  1. Turf: 58.6%
  2. CCA: 22.7%
  3. Hard coral: 10.8%
  4. Macroalgae: 1.0%
  5. Soft coral: 0.7%

Cluster 2:
  1. Turf: 41.3%
  2. Hard coral: 39.9%
  3. CCA: 12.8%
  4. Soft coral: 1.1%
  5. Zoanthid: 0.6%

Cluster 3:
  1. Hard coral: 57.7%
  2. Turf: 28.1%
  3. CCA: 8.2%
  4. Soft coral: 1.2%
  5. Zoanthid: 0.4%

Cluster 4:
  1. Turf: 55.3%
  2. Hard coral: 14.9%
  3. Soft coral: 10.2%
  4. CCA: 9.4%
  5. Zoanthid: 0.8%

Cluster 5:
  1. Turf: 37.1%
  2. Hard coral: 32.1%
  3. CCA: 15.4%
  4. Zoanthid: 10.5%
  5. Soft coral: 0.8%

Cluster 6:
  1. Hard coral: 47.0%
  2. Turf: 33.4%
  3. CCA: 11.0%
  4. Soft coral: 2.1%
  5. Zoanthid: 0.6%

