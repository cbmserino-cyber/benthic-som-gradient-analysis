Created directory: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp
Created directory: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp
Available base directories: ['/home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp', '/home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp']
Created directory: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5
Created directory: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5
Available analysis directories: ['/home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5', '/home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5']
Node cluster map shape: (29, 27)
Should match U-Matrix: (29, 27)
‚úì U-Matrix with hits overlay saved: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/umatrix_hitmap_overlay.png
‚úì U-Matrix with hits overlay saved: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/umatrix_hitmap_overlay.png
‚úì U-Matrix with hits overlay saved: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/umatrix_normalized_hitmap_overlay.png
‚úì U-Matrix with hits overlay saved: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/umatrix_normalized_hitmap_overlay.png
SOM Node Cluster Map (Predicted):
[[3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 2 2 2 2 2 3]
 [3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 2 2 2 3 3]
 [3 3 3 1 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 2 3 3 3]
 [3 3 3 3 1 1 1 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3]
 [3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 1 1 3 3 3 3 3 3 3 3]
 [3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 2 2 2 2]
 [3 3 3 3 3 3 3 3 3 3 3 3 3 3 2 3 3 3 3 3 3 3 2 2 2 2 2]
 [3 3 3 3 3 3 3 3 3 3 3 3 3 2 2 2 3 3 3 3 3 3 2 2 2 2 2]
 [3 3 3 3 3 3 3 3 3 3 3 3 3 3 2 3 3 3 3 3 3 3 2 2 2 2 2]
 [3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 2 2 2 2 2]
 [1 1 1 1 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 2 3]
 [1 1 1 1 1 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3]
 [1 1 1 1 1 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3]
 [1 1 1 1 1 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3]
 [1 1 1 1 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3]
 [1 1 1 1 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3]
 [3 3 1 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 1 3 3 3 3 3 3 3 3]
 [3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3]
 [3 3 3 3 3 3 3 3 3 1 1 1 1 1 1 3 3 3 3 3 3 3 3 3 3 3 3]
 [3 3 3 3 2 3 3 3 1 1 1 1 1 1 1 1 1 1 1 3 3 3 3 3 3 3 2]
 [3 3 3 2 2 2 3 3 1 1 1 1 1 1 1 1 1 1 1 3 3 3 3 3 3 3 3]
 [3 3 3 2 4 4 3 3 1 1 1 1 1 1 1 1 1 1 1 3 3 3 3 3 3 3 3]
 [3 3 2 4 4 4 4 3 1 1 1 1 1 1 1 1 1 1 1 3 3 3 3 3 3 3 3]
 [3 2 2 2 4 4 4 3 3 1 1 1 1 1 1 1 1 1 1 3 3 3 3 3 3 3 3]
 [2 2 2 2 2 4 4 4 3 3 1 1 1 1 1 1 1 1 1 3 3 3 1 1 1 3 3]
 [2 2 2 2 3 3 4 4 4 3 1 1 1 1 1 1 1 1 3 3 3 1 1 1 1 1 1]
 [2 2 2 3 3 3 3 3 3 3 3 1 1 1 2 2 2 2 2 2 1 1 1 1 1 1 1]
 [3 3 3 3 3 3 3 3 3 3 3 1 1 1 2 2 2 2 2 2 1 1 1 1 1 1 1]
 [4 3 3 3 3 3 3 3 3 3 3 1 1 1 2 2 2 2 2 2 1 1 1 1 1 1 1]]
Final DataFrame with SOM clusters saved to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/df2_predicted_clusters.csv
Final DataFrame with SOM clusters saved to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/df2_predicted_clusters.csv

Color assignments:
  Cluster 1: RGB [31, 119, 180]
  Cluster 2: RGB [152, 223, 138]
  Cluster 3: RGB [140, 86, 75]
  Cluster 4: RGB [199, 199, 199]
‚úì Plot saved successfully to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/som_node_predicted_cluster_map.png
‚úì Cluster data saved to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/som_node_predicted_cluster_map.npy
‚úì Cluster data saved as CSV: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/som_node_predicted_cluster_map2.csv
‚úì Color mapping saved to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/cluster_colors2.txt
‚úì Plot saved successfully to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/som_node_predicted_cluster_map.png
‚úì Cluster data saved to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/som_node_predicted_cluster_map.npy
‚úì Cluster data saved as CSV: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/som_node_predicted_cluster_map2.csv
‚úì Color mapping saved to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/cluster_colors2.txt

==================================================
CLUSTER STATISTICS:
==================================================
Total SOM nodes: 783 (29 √ó 27)

Cluster distribution:
  Cluster 1: 151 nodes (19.3%)
  Cluster 2: 79 nodes (10.1%)
  Cluster 3: 537 nodes (68.6%)
  Cluster 4: 16 nodes (2.0%)

Number of clusters found: 4
Clusters present: [1, 2, 3, 4]

SOM‚ÄìKMeans Cluster Support (weighted by hit counts)
============================================================
Cluster   Total hits     Mean/node      Median    Core frac (>10 hits)
1         4375           28.97          6.0       27.8%
2         1946           24.63          6.0       34.2%
3         4356           8.11           3.0       19.6%
4         355            22.19          9.5       43.8%
Neighborhood Preservation Index: 0.066
U-Matrix saved to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/u_matrix.png
U-Matrix saved to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/u_matrix.png
Node cluster map shape: (29, 27)
Should match U-Matrix: (29, 27)
‚úì U-Matrix with KMeans overlay saved: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/umatrix_predicted_kmeans_overlay.png
‚úì U-Matrix with KMeans overlay saved: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/umatrix_predicted_kmeans_overlay.png

üéØ ENVIRONMENTAL ANALYSIS: manhattan
Cluster column: predicted_Cluster
Analyzing 0 environmental variables
‚ùå No environmental variables found!
‚úì Plot saved successfully to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/som_node_cluster_map.png
‚úì Cluster data saved to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/som_node_cluster_map.npy
‚úì Cluster data saved as CSV: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/som_node_cluster_map.csv
‚úì Color mapping saved to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/cluster_colors2.txt
‚úì Plot saved successfully to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/som_node_cluster_map.png
‚úì Cluster data saved to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/som_node_cluster_map.npy
‚úì Cluster data saved as CSV: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/som_node_cluster_map.csv
‚úì Color mapping saved to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/cluster_colors2.txt
Node cluster map shape: (29, 27)
Should match U-Matrix: (29, 27)
‚úì U-Matrix with KMeans overlay saved: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/umatrix_kmeans_overlay.png
‚úì U-Matrix with KMeans overlay saved: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/umatrix_kmeans_overlay.png
ARI: 0.115, NMI: 0.204
Failed to save final DataFrame: expected str, bytes or os.PathLike object, not list
Saved df2 with cluster info to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5
Saved df2 with cluster info to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5

üéØ ASSEMBLAGE GRADIENT ANALYSIS: PCA
Gradient axis: PC1
Analyzing 319 assemblage variables

üìä CORRELATION RESULTS:
          Spearman_r  p_value   abs_r   fdr_q significance
variable                                                  
acaenc       -0.0109   0.2524  0.0109  0.3035           ns
acrarb       -0.2281   0.0000  0.2281  0.0000          ***
acrbus       -0.1079   0.0000  0.1079  0.0000          ***
acrenc       -0.1177   0.0000  0.1177  0.0000          ***
acrtab       -0.2684   0.0000  0.2684  0.0000          ***
...              ...      ...     ...     ...          ...
turfol       -0.1942   0.0000  0.1942  0.0000          ***
tursed       -0.4447   0.0000  0.4447  0.0000          ***
xesmas       -0.0105   0.2722  0.0105  0.3174           ns
zoaenc        0.0196   0.0398  0.0196  0.0565           ns
zoncof        0.0044   0.6432  0.0044  0.6865           ns

[95 rows x 5 columns]

üí™ STRONG GRADIENT DRIVERS (|r| > 0.5):
  othcca: r = 0.548, p = 0
  turfil: r = 0.845, p = 0
üìâ Plotting 5 strong gradient taxa
‚úÖ Saved: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5
‚úÖ Saved: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5
Map plot saved successfully to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/spatial_clusters_taiwan_geomap.png
Map plot saved successfully to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/spatial_clusters_taiwan_geomap.png
Plot saved successfully to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/spatial_clusters_taiwan_shmap.png
Plot saved successfully to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/spatial_clusters_taiwan_shmap.png
Plot saved successfully to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/spatial_clusters_westtaiwan_shmap.png
Plot saved successfully to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/spatial_clusters_westtaiwan_shmap.png
Plot saved successfully to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/spatial_clusters_southtaiwan_shmap.png
Plot saved successfully to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/spatial_clusters_southtaiwan_shmap.png
Plot saved successfully to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/spatial_clusters_northtaiwan_shmap.png
Plot saved successfully to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/spatial_clusters_northtaiwan_shmap.png
Saved: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/richness_by_cluster.png
Saved: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/richness_by_cluster.png
Map plot saved successfully to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/species_richness_taiwan_geomap.png
Map plot saved successfully to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/species_richness_taiwan_geomap.png
Saved species richness map to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/species_richness_taiwan_shmap.png
Saved species richness map to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/species_richness_taiwan_shmap.png
Plot saved successfully to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/Species_overlay.png
Plot saved successfully to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/Species_overlay.png
Plot saved successfully to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/composition_by_cluster.png
Plot saved successfully to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/composition_by_cluster.png
Plot saved successfully to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/composition_by_cluster.png
Plot saved successfully to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/composition_by_cluster.png
Plot saved successfully to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/composition_by_cluster_top5.png
Plot saved successfully to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/composition_by_cluster_top5.png

Top 5 Categories per Cluster:
==================================================
Cluster 0:
  1. Hard coral: 41.4%
  2. Turf: 27.9%
  3. Soft coral: 12.0%
  4. CCA: 10.5%
  5. Zoanthid: 0.7%

Cluster 1:
  1. Hard coral: 34.5%
  2. Turf: 31.2%
  3. Soft coral: 16.5%
  4. CCA: 11.2%
  5. Macroalgae: 1.0%

Cluster 2:
  1. Turf: 41.4%
  2. Hard coral: 39.9%
  3. CCA: 12.8%
  4. Soft coral: 1.1%
  5. Zoanthid: 0.6%

Cluster 3:
  1. Hard coral: 53.4%
  2. Turf: 30.8%
  3. CCA: 8.6%
  4. Soft coral: 1.9%
  5. Zoanthid: 0.6%

Cluster 4:
  1. Turf: 57.2%
  2. CCA: 19.6%
  3. Hard coral: 12.8%
  4. Zoanthid: 1.8%
  5. Soft coral: 1.5%

Plot saved successfully to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/composition_by_cluster_top5_others.png
Plot saved successfully to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/composition_by_cluster_top5_others.png
Plot saved successfully to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/majorcatcompo_bars.png
Plot saved successfully to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/majorcatcompo_bars.png
Saved stacked bar chart to /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/majorcatcompo_bars.png
Saved stacked bar chart to /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/majorcatcompo_bars.png
Saved stacked bar chart to /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/majorcatcompo_bars.png
Saved stacked bar chart to /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/majorcatcompo_bars.png
Overlay plot saved: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/u_matrix_overlay_site.png
Overlay plot saved: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/u_matrix_overlay_site.png
Overlay plot saved: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/u_matrix_overlay_site_count.png
Overlay plot saved: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/u_matrix_overlay_site_count.png
Overlay plot saved: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/u_matrix_overlay_cluster.png
Overlay plot saved: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/u_matrix_overlay_cluster.png
Colored cluster overlay saved: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/u_matrix_kmeans_colored.png
Colored cluster overlay saved: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/u_matrix_kmeans_colored.png
Classification Report:
              precision    recall  f1-score   support

           1       1.00      0.99      1.00       213
           2       1.00      0.93      0.96       164
           3       1.00      0.99      1.00       291
           4       1.00      0.98      0.99       441
           5       0.99      1.00      0.99      2201

    accuracy                           0.99      3310
   macro avg       1.00      0.98      0.99      3310
weighted avg       0.99      0.99      0.99      3310


Visualizing results...
confusion matrix plot saved: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/confusion_matrix.png
confusion matrix plot saved: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/confusion_matrix.png
Simplified node purity plot saved: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/node_purity_simplified.png
Simplified node purity plot saved: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/node_purity_simplified.png
Node diversity per site saved: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/node_diversity_per_site.png
Node diversity per site saved: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/node_diversity_per_site.png
Node diversity per site saved: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/node_diversity_per_site.png
Node diversity per site saved: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/node_diversity_per_site.png
‚úì Top 15 concentrated sites plot saved: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/top_15_concentrated_sites.png
‚úì Top 15 concentrated sites plot saved: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/top_15_concentrated_sites.png
Node diversity per site saved: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/node_uniques_persite.png
Node diversity per site saved: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/node_uniques_persite.png
Node diversity per site saved: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/node_coverage.png
Node diversity per site saved: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/node_coverage.png
‚úì Top 15 spatially spread sites plot saved: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/top_15_spatially_spread_sites.png
‚úì Top 15 spatially spread sites plot saved: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/top_15_spatially_spread_sites.png
‚úì Spread vs concentration scatter plot saved: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/spread_vs_concentration_scatter.png
‚úì Spread vs concentration scatter plot saved: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/spread_vs_concentration_scatter.png
‚úì Spread vs clustered comparison saved: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/spread_vs_clustered_comparison.png
‚úì Spread vs clustered comparison saved: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/spread_vs_clustered_comparison.png
‚úì Data files saved to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5
‚úì Data files saved to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5

============================================================
TOP 15 SPATIAL SPREAD ANALYSIS
============================================================

Top 15 Most Spatially Spread Sites:
--------------------------------------------------
 1. Fenniaolin          : Spread=19.10 | Concentration=20.0% | Samples=105 | Diversity=3.08
 2. Dengta              : Spread=18.62 | Concentration=10.5% | Samples=105 | Diversity=3.64
 3. Pengjia             : Spread=18.61 | Concentration=18.9% | Samples=106 | Diversity=3.56
 4. Xijiyu              : Spread=18.49 | Concentration=14.3% | Samples=105 | Diversity=3.06
 5. Hujingyu_North      : Spread=18.37 | Concentration=18.1% | Samples=105 | Diversity=3.12
 6. Toujinyu            : Spread=18.03 | Concentration=11.4% | Samples=105 | Diversity=3.58
 7. Yayo                : Spread=17.84 | Concentration=17.1% | Samples=105 | Diversity=3.33
 8. Tiezhenyu_South     : Spread=17.80 | Concentration=24.8% | Samples=105 | Diversity=2.77
 9. Maobitou            : Spread=17.71 | Concentration=10.5% | Samples=105 | Diversity=3.74
10. Dingbaisha          : Spread=17.71 | Concentration=13.3% | Samples=105 | Diversity=3.06
11. Keelungyu           : Spread=17.64 | Concentration=38.1% | Samples=105 | Diversity=2.71
12. Qixingyan           : Spread=17.63 | Concentration=37.1% | Samples=105 | Diversity=2.32
13. Sijiaoyu            : Spread=17.48 | Concentration=17.1% | Samples=105 | Diversity=2.64
14. Mianhua             : Spread=17.41 | Concentration=10.5% | Samples=105 | Diversity=3.82
15. Maoyu               : Spread=17.37 | Concentration=7.6% | Samples=105 | Diversity=3.77

Top 15 Most Clustered Sites:
--------------------------------------------------
 1. Zhaoyang            : Spread=3.53 | Concentration=25.7% | Samples=105 | Diversity=2.16
 2. Jiqi                : Spread=4.09 | Concentration=19.0% | Samples=105 | Diversity=2.40
 3. Midaoyu             : Spread=5.59 | Concentration=45.7% | Samples=105 | Diversity=1.23
 4. Huaping             : Spread=6.27 | Concentration=33.3% | Samples=105 | Diversity=2.01
 5. Shimendong          : Spread=7.12 | Concentration=60.0% | Samples=105 | Diversity=1.26
 6. Guian_Harbor        : Spread=8.47 | Concentration=21.9% | Samples=105 | Diversity=2.71
 7. Xiaoxianglan        : Spread=8.48 | Concentration=15.2% | Samples=105 | Diversity=2.80
 8. Qingwan_Inner_Bay   : Spread=8.55 | Concentration=32.4% | Samples=105 | Diversity=2.60
 9. Shiyusan            : Spread=9.81 | Concentration=21.0% | Samples=105 | Diversity=2.75
10. Dafu                : Spread=10.24 | Concentration=21.3% | Samples=169 | Diversity=3.02
11. Ponpontan           : Spread=10.34 | Concentration=16.2% | Samples=105 | Diversity=2.98
12. Zhongao_Beach       : Spread=10.36 | Concentration=21.9% | Samples=105 | Diversity=2.24
13. Longxiadong         : Spread=11.29 | Concentration=19.4% | Samples=170 | Diversity=2.83
14. Qimei               : Spread=11.31 | Concentration=14.0% | Samples=107 | Diversity=3.14
15. Xiaowan             : Spread=11.74 | Concentration=16.2% | Samples=105 | Diversity=3.23

INTERESTING PATTERNS:
--------------------------------------------------

‚Ä¢ Sites with high spread BUT low concentration (<30%):
  Fenniaolin: Spread=19.10, Concentration=20.0%
  Dengta: Spread=18.62, Concentration=10.5%
  Dingbaisha: Spread=17.71, Concentration=13.3%
  Maobitou: Spread=17.71, Concentration=10.5%
  Mianhua: Spread=17.41, Concentration=10.5%
  Pengjia: Spread=18.61, Concentration=18.9%
  Yayo: Spread=17.84, Concentration=17.1%
  Hujingyu_North: Spread=18.37, Concentration=18.1%
  Maoyu: Spread=17.37, Concentration=7.6%
  Sijiaoyu: Spread=17.48, Concentration=17.1%
  Tiezhenyu_South: Spread=17.80, Concentration=24.8%
  Toujinyu: Spread=18.03, Concentration=11.4%
  Xijiyu: Spread=18.49, Concentration=14.3%
Node diversity per site saved: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/node_shannonvsunique.png
Node diversity per site saved: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/node_shannonvsunique.png
Detailed node diversity analysis saved: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/node_diversity_per_site.csv
Detailed node diversity analysis saved: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/node_diversity_per_site.csv

============================================================
ANALYSIS COMPLETE
============================================================
This analysis reveals:
‚Ä¢ CONCENTRATED SITES: Samples cluster in few nodes (environmental homogeneity)
‚Ä¢ DIVERSE SITES: Samples spread across many nodes (environmental variability)
‚Ä¢ SPATIAL SPREAD: How widely sites' samples distribute across the SOM
‚Ä¢ NODE COVERAGE: Efficiency of node usage per site
Index(['node', 'cluster', 'purity', 'entropy', 'majority_label',
       'disagreement_rate', 'counts'],
      dtype='object')
     node  cluster    purity  ...  majority_label  disagreement_rate                      counts
0  (0, 0)       14  0.857143  ...             2.0           1.000000               {2: 12, 5: 2}
1  (0, 1)       28  0.678571  ...             2.0           1.000000         {5: 8, 2: 19, 1: 1}
2  (0, 2)       25  0.800000  ...             2.0           1.000000               {2: 20, 5: 5}
3  (0, 3)       52  0.557692  ...             2.0           0.980769  {5: 17, 2: 29, 1: 5, 3: 1}
4  (0, 4)       67  0.656716  ...             5.0           1.000000        {2: 20, 5: 44, 1: 3}

[5 rows x 7 columns]
purity heatmap saved: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/purity_matrix.png
purity heatmap saved: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/purity_matrix.png
Global Adjusted Rand Index (ARI): 0.11473294670204612
Global Normalized Mutual Info (NMI): 0.20417491276256117
609 transitional nodes detected:
         node    purity  disagreement_rate  majority_label
0      (0, 0)  0.857143           1.000000             2.0
1      (0, 1)  0.678571           1.000000             2.0
2      (0, 2)  0.800000           1.000000             2.0
3      (0, 3)  0.557692           0.980769             2.0
4      (0, 4)  0.656716           1.000000             5.0
..        ...       ...                ...             ...
778  (28, 22)  0.886792           1.000000             1.0
779  (28, 23)  0.714286           1.000000             1.0
780  (28, 24)  0.896104           1.000000             1.0
781  (28, 25)  0.979021           1.000000             1.0
782  (28, 26)  0.555556           1.000000             1.0

[609 rows x 4 columns]
Type of node_stats: <class 'pandas.core.frame.DataFrame'>
node_stats keys: Index(['node', 'cluster', 'purity', 'entropy', 'majority_label',
       'disagreement_rate', 'counts'],
      dtype='object')
Found 5 unique clusters: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5)]
Using 5 colors, n_clusters parameter = 5
Node composition pies saved: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/node_composition_pies.png
Node composition pies saved: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/node_composition_pies.png
           purity     entropy  disagreement_rate
count  671.000000  671.000000         671.000000
mean     0.815478    0.544948           0.841719
std      0.194057    0.518267           0.298419
min      0.333333   -0.000000           0.000000
25%      0.666667   -0.000000           0.809524
50%      0.875000    0.591673           1.000000
75%      1.000000    0.970951           1.000000
max      1.000000    1.728001           1.000000
Plot saved: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/between_node_distance.png
Plot saved: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/between_node_distance.png
Category overlay plot saved: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/driver_overlay_panels_cleaned.png
Category overlay plot saved: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/driver_overlay_panels_cleaned.png

üìä CLUSTER COMPOSITION BY MAJOR CATEGORIES
‚úì Cluster composition saved: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5
‚úì Cluster composition saved: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5

üîç IDENTIFYING SIGNATURE SPECIES PER CLUSTER

üìà Analyzing Cluster 1:
   Size: 711 samples
   Total abundance: 0.94
   üéØ Most enriched species (enrichment score):
      turfol               (Hard coral               ): 14.07x
      acrarb               (Hard coral               ): 12.96x
      ascere               (Ascidian                 ): 10.93x
      claclu               (Soft coral               ): 10.48x
      litbus               (Soft coral               ): 9.45x
   üìä Most abundant species (absolute mean):
      acrarb               (Hard coral               ): 0.153
      tursed               (Turf                     ): 0.142
      turfil               (Turf                     ): 0.136
      turfol               (Hard coral               ): 0.088
      claclu               (Soft coral               ): 0.065

üìà Analyzing Cluster 2:
   Size: 548 samples
   Total abundance: 0.96
   üéØ Most enriched species (enrichment score):
      helbus               (Hard coral               ): 12.47x
      sindig               (Soft coral               ): 11.73x
      serbus               (Hard coral               ): 10.82x
      milenc               (Hard coral               ): 9.17x
      loodig               (Soft coral               ): 7.85x
   üìä Most abundant species (absolute mean):
      turfil               (Turf                     ): 0.215
      sindig               (Soft coral               ): 0.149
      helbus               (Hard coral               ): 0.109
      tursed               (Turf                     ): 0.097
      milenc               (Hard coral               ): 0.064

üìà Analyzing Cluster 3:
   Size: 968 samples
   Total abundance: 0.97
   üéØ Most enriched species (enrichment score):
      atrenc               (Hard coral               ): 9.13x
      pocbus               (Hard coral               ): 7.50x
      stybus               (Hard coral               ): 3.44x
      ispcol               (Hard coral               ): 3.16x
      ispenc               (Hard coral               ): 2.48x
   üìä Most abundant species (absolute mean):
      turfil               (Turf                     ): 0.336
      pocbus               (Hard coral               ): 0.146
      othcca               (CCA                      ): 0.083
      monenc               (Hard coral               ): 0.078
      tursed               (Turf                     ): 0.077

üìà Analyzing Cluster 4:
   Size: 1471 samples
   Total abundance: 0.96
   üéØ Most enriched species (enrichment score):
      symenc               (Hard coral               ): 6.33x
      monfol               (Hard coral               ): 5.73x
      ecoenc               (Hard coral               ): 5.11x
      potmas               (Hard coral               ): 4.88x
      ecofol               (Hard coral               ): 4.31x
   üìä Most abundant species (absolute mean):
      turfil               (Turf                     ): 0.192
      monenc               (Hard coral               ): 0.134
      tursed               (Turf                     ): 0.116
      monfol               (Hard coral               ): 0.093
      acrtab               (Hard coral               ): 0.076

üìà Analyzing Cluster 5:
   Size: 7334 samples
   Total abundance: 0.95
   üéØ Most enriched species (enrichment score):
      neucom               (Macroalgae               ): 1.50x
      zoncof               (Macroalgae               ): 1.50x
      mesart               (Macroalgae               ): 1.48x
      redcof               (Macroalgae               ): 1.46x
      padcof               (Macroalgae               ): 1.45x
   üìä Most abundant species (absolute mean):
      turfil               (Turf                     ): 0.388
      tursed               (Turf                     ): 0.183
      othcca               (CCA                      ): 0.108
      pescca               (CCA                      ): 0.088
      faienc               (Hard coral               ): 0.018
‚úì Signature species analysis saved: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5
‚úì Signature species analysis saved: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5
Plot saved successfully to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/transition_1_to_2.png
Plot saved successfully to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/transition_1_to_2.png
Saved: transition_1_to_2.png
Transition vectors saved to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/transition_vectors_cluster_1_to_2.csv
Transition vectors saved to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/transition_vectors_cluster_1_to_2.csv
Plot saved successfully to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/transition_1_to_3.png
Plot saved successfully to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/transition_1_to_3.png
Saved: transition_1_to_3.png
Transition vectors saved to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/transition_vectors_cluster_1_to_3.csv
Transition vectors saved to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/transition_vectors_cluster_1_to_3.csv
Plot saved successfully to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/transition_1_to_4.png
Plot saved successfully to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/transition_1_to_4.png
Saved: transition_1_to_4.png
Transition vectors saved to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/transition_vectors_cluster_1_to_4.csv
Transition vectors saved to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/transition_vectors_cluster_1_to_4.csv
Plot saved successfully to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/transition_1_to_5.png
Plot saved successfully to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/transition_1_to_5.png
Saved: transition_1_to_5.png
Transition vectors saved to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/transition_vectors_cluster_1_to_5.csv
Transition vectors saved to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/transition_vectors_cluster_1_to_5.csv
No transition samples between Cluster 1 and 6
No transition samples between Cluster 1 and 7
Plot saved successfully to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/transition_2_to_3.png
Plot saved successfully to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/transition_2_to_3.png
Saved: transition_2_to_3.png
Transition vectors saved to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/transition_vectors_cluster_2_to_3.csv
Transition vectors saved to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/transition_vectors_cluster_2_to_3.csv
Plot saved successfully to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/transition_2_to_4.png
Plot saved successfully to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/transition_2_to_4.png
Saved: transition_2_to_4.png
Transition vectors saved to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/transition_vectors_cluster_2_to_4.csv
Transition vectors saved to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/transition_vectors_cluster_2_to_4.csv
Plot saved successfully to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/transition_2_to_5.png
Plot saved successfully to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/transition_2_to_5.png
Saved: transition_2_to_5.png
Transition vectors saved to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/transition_vectors_cluster_2_to_5.csv
Transition vectors saved to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/transition_vectors_cluster_2_to_5.csv
No transition samples between Cluster 2 and 6
No transition samples between Cluster 2 and 7
Plot saved successfully to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/transition_3_to_4.png
Plot saved successfully to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/transition_3_to_4.png
Saved: transition_3_to_4.png
Transition vectors saved to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/transition_vectors_cluster_3_to_4.csv
Transition vectors saved to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/transition_vectors_cluster_3_to_4.csv
Plot saved successfully to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/transition_3_to_5.png
Plot saved successfully to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/transition_3_to_5.png
Saved: transition_3_to_5.png
Transition vectors saved to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/transition_vectors_cluster_3_to_5.csv
Transition vectors saved to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/transition_vectors_cluster_3_to_5.csv
No transition samples between Cluster 3 and 6
No transition samples between Cluster 3 and 7
Plot saved successfully to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/transition_4_to_5.png
Plot saved successfully to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/transition_4_to_5.png
Saved: transition_4_to_5.png
Transition vectors saved to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/transition_vectors_cluster_4_to_5.csv
Transition vectors saved to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/transition_vectors_cluster_4_to_5.csv
No transition samples between Cluster 5 and 7
No transition samples between Cluster 6 and 7
Simplified transition visualization saved to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/transition_zones.png
Simplified transition visualization saved to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/transition_zones.png
PCA visualization saved to: /home/bernard/Dropbox/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/pca_clusters.png
PCA visualization saved to: /home/bernard/cbmserino/IMEE/marine_som/2phase/144000iter/29x27/manhattan_som_sp/nclust5/pca_clusters.png
..... 
.... 
... 
.. 
. 
 
Analysis complete!
